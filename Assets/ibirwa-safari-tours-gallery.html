<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gallery</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="../css/services.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tailwindcss@latest/dist/tailwind.min.css"
    />
    <script
      src="https://kit.fontawesome.com/a076d05399.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body class="bg-gray-100 p-6">
    <!-- Navigation Bar -->
    <nav class="bg-blue-600 p-4 text-white">
      <div class="container mx-auto flex justify-between items-center">
        <button id="menu-toggle" class="md:hidden text-2xl focus:outline-none">
          <i class="fas fa-bars"></i>
        </button>
        <a href="/" class="text-xl font-bold">IBIRWA Safari Tours</a>
        <div class="hidden md:flex space-x-4">
          <a href="/" class="hover:underline">Home</a>
          <a href="/gallery.html" class="hover:underline">Gallery</a>
        </div>
        <div class="relative group acountsettings">
          <button
            class="relative flex sm:hidden items-center space-x-2 focus:outline-none"
          >
            <span class="font-semibold"
              ><i class="fa-solid fa-gear"></i> Settings</span
            >
            <i id="menu_settings" class="fas fa-caret-down"></i>
          </button>
          <div
            class="settings absolute right-0 mt-2 w-48 bg-white text-black rounded-lg shadow-lg hidden group-hover:block"
          >
            <span class="block px-4 py-2 hover:bg-gray-200">Profile</span>
            <span class="block px-4 py-2 hover:bg-gray-200">User Name</span>
            <span
              id="logout"
              class="block text-xl-800 font-bold px-4 py-2 hover:text-red-700"
              >Logout</span
            >
          </div>
        </div>
        
      </div>


      <div id="mobile-menu" class="hidden md:hidden">
        <a href="/" class="block px-4 py-2 hover:bg-blue-500">Home</a>
        <a href="/gallery.html" class="block px-4 py-2 hover:bg-blue-500"
          >Gallery</a
        >
          <button
            class="flex items-center space-x-2 focus:outline-none"
          >
            <span class="font-semibold"
              ><i class="fa-solid fa-gear"></i> Settings</span
            >
          </button>
          <div class=" mt-2 text-black  group-hover:block">
            <span class="block px-4 py-2 hover:text-gray-200">Profile</span>
            <span class="block px-4 py-2 hover:text-gray-200">User Name</span>
            <span
              class="block  px-4 py-2 hover:text-gray-200"
              >Logout</span
            >
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto mt-6">
      <h1 class="capitalize text-3xl font-bold mb-6 text-center">
        Our Photo Gallery
      </h1>
      <div
        id="imageContainer"
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
      ></div>
      <p id="errorMessage" class="text-red-500 text-center mt-4 hidden"></p>
    </div>

    <!-- Footer -->
    <footer class="bg-blue-600 text-white mt-12 p-4">
      <div
        class="container mx-auto text-center md:flex md:justify-between md:items-center"
      >
        <p class="text-sm lg:text-xl">
          &copy; 2024 IBIRWA Safari Tours. All rights reserved.
        </p>

      </div>
      <div class="container mx-auto text-center mt-4">
        <div class="flex justify-center space-x-4">
          <a
            href="https://facebook.com"
            target="_blank"
            class="text-white hover:text-gray-300"
          >
            <i class="fab fa-facebook-f"></i>
          </a>
          <a
            href="https://instagram.com"
            target="_blank"
            class="text-white hover:text-gray-300"
          >
            <i class="fab fa-instagram"></i>
          </a>
          <a
            href="https://linkedin.com"
            target="_blank"
            class="text-white hover:text-gray-300"
          >
            <i class="fab fa-linkedin-in"></i>
          </a>
          <a
            href="https://twitter.com"
            target="_blank"
            class="text-white hover:text-gray-300"
          >
            <i class="fab fa-twitter"></i>
          </a>
        </div>
      </div>
    </footer>

    <script>
      async function fetchImages() {
        try {
          const response = await fetch("https://kivu-back-end.onrender.com/api/gallery");

          if (!response.ok) {
            console.error("Response status:", response.status); // Debugging line
            throw new Error("Failed to fetch images");
          }

          const gallery = await response.json();
          const imagesContainer = document.getElementById("imageContainer");

          if (gallery.length === 0) {
            imagesContainer.innerHTML =
              '<p class="text-gray-700 text-center">No images available yet.</p>';
            return;
          }

          gallery.forEach((card) => {
            // Create a photo card for each image
            const cardElement = document.createElement("div");
            cardElement.className = "bg-white p-4 rounded shadow-lg";
            cardElement.innerHTML = `
            <img src="${card.imageUrl}" alt="${card.title}" class="w-full h-48 object-cover rounded mb-4">
            <h2 class="text-lg font-bold mb-2">${card.title}</h2>
          `;
            imagesContainer.appendChild(cardElement);
          });
        } catch (error) {
          console.error("Error fetching images:", error);
          const errorMessage = document.getElementById("errorMessage");
          errorMessage.innerText = "Error: " + error.message;
          errorMessage.classList.remove("hidden");
        }
      }
      // Fetch images when the page loads
      fetchImages();

      // Toggle mobile menu
      document.getElementById("menu-toggle").addEventListener("click", () => {
        const mobileMenu = document.getElementById("mobile-menu");
        mobileMenu.classList.toggle("hidden");
      });
      //open settings
      const settings = document.querySelector(".settings");
      //desktop settings
      document.getElementById("menu_settings").addEventListener("click", () => {
        settings.classList.toggle("hidden");
      });

      //logout
      document.getElementById("logout").addEventListener("click", async (e) => {
        e.preventDefault();
        // Perform any necessary logout operations here, such as clearing tokens or session data
        console.log("User logged out");
        if (confirm("Are you sure you want to logout?")) {
          alert("Logout successful");
          window.location.href = "/index.html";
        }
      });

      
      //logout
  document.getElementById('logoutButton').addEventListener('click', async () => {
  const response = await fetch('/api/ibirwa-clients/logout', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    }
  });
  const result = await response.json();
  alert(result.message);
  // Remove the token from localStorage
  localStorage.removeItem('token');
});
    </script>
  </body>
</html>
